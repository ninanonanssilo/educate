const form = document.getElementById("doc-form");
const subjectInput = document.getElementById("subject");
const recipientInput = document.getElementById("recipient");
const viaInput = document.getElementById("via");
const senderInput = document.getElementById("sender");
const dateInput = document.getElementById("date");
const detailsInput = document.getElementById("details");
const attachmentsInput = document.getElementById("attachments");
const useAttachmentPhraseInput = document.getElementById("use-attachment-phrase");
const toneSelect = document.getElementById("tone");
const docnoInput = document.getElementById("docno");
const ownerInput = document.getElementById("owner");
const contactInput = document.getElementById("contact");
const relatedInput = document.getElementById("related");
const templateSelect = document.getElementById("template");
const templateSearchInput = document.getElementById("template-search");
const templateSearchHint = document.getElementById("template-search-hint");
const applyTemplateBtn = document.getElementById("apply-template-btn");
const resetBtn = document.getElementById("reset-btn");
const result = document.getElementById("result");
const copyBtn = document.getElementById("copy-btn");
const downloadBtn = document.getElementById("download-btn");
const statusText = document.getElementById("status");
const submitButton = form.querySelector("button[type='submit']");

const STORAGE_KEY = "official_letter_helper_form_v1";
const DEFAULTS = {
  recipient: "내부결재",
  sender: "00초등학교장",
  tone: "default",
  useAttachmentPhrase: true,
};

const TEMPLATES = [
  {
    id: "open-class",
    category: "행사/학부모",
    label: "학부모 공개수업 운영",
    subject: "2026학년도 학부모 공개수업 운영 계획",
    details:
      "- 목적: 학부모의 교육활동 참여 확대 및 교육과정 이해 제고\n- 추진 내용: 학년(군)별 공개수업 운영, 참관 안내, 안전 및 질서 유지 협조\n- 협조 요청: 학부모 출입 및 주차 안내, 담임교사 수업 공개 준비, 방역/안전 점검\n- 일정: (추후 안내 또는 붙임 참조)",
    attachments: ["운영 계획(안) 1부", "학년별 운영 시간표 1부"],
  },
  {
    id: "field-trip",
    category: "체험/안전",
    label: "현장체험학습 운영 안내",
    subject: "현장체험학습 운영 계획(안) 보고",
    details:
      "- 목적: 교육과정 연계 체험활동 운영\n- 추진 내용: 사전 안전교육 실시, 인솔 및 비상연락체계 구축, 안전점검\n- 협조 요청: 관련 부서 협조(차량/보험/안전), 학부모 안내(추후)\n- 일정/장소: (미확정 시 '추후 안내' 또는 '붙임 참조')",
    attachments: ["운영 계획(안) 1부", "안전교육 자료 1부"],
  },
  {
    id: "infection",
    category: "보건",
    label: "감염병 예방 협조",
    subject: "감염병 예방을 위한 협조 요청",
    details:
      "- 목적: 감염병 확산 예방 및 학생 건강 보호\n- 추진 내용: 개인위생 수칙 안내, 유증상 시 등교중지 및 보호자 연락, 교실 환기\n- 협조 요청: 가정 내 증상 발생 시 즉시 담임교사에게 알림, 예방수칙 준수\n- 기타: 구체 상황은 학교 안내 및 보건당국 지침에 따름",
    attachments: ["예방수칙 안내문 1부"],
  },
  {
    id: "after-school",
    category: "방과후/돌봄",
    label: "방과후학교 운영",
    subject: "방과후학교 운영 계획(안) 보고",
    details:
      "- 목적: 학생 맞춤형 교육활동 제공 및 돌봄 지원\n- 추진 내용: 프로그램 편성, 강사 운영, 안전관리 및 출결 관리\n- 협조 요청: 관련 예산 집행 및 시설 사용 협조, 학생 안전 지도\n- 일정: (붙임 참조)",
    attachments: ["운영 계획(안) 1부", "프로그램 편성표 1부"],
  },
  {
    id: "student-record-check",
    category: "점검/평가",
    label: "학교생활기록부 점검 계획",
    subject: "학교생활기록부 기재사항 점검 계획(안) 수립",
    details:
      "- 목적: 학교생활기록부 기재의 정확성 및 신뢰도 제고\n- 추진 내용: 학년별 자체 점검, 입력 오류 및 누락 여부 확인, 항목별 점검 체크리스트 활용\n- 협조 요청: 담임 및 교과(전담)교사 기재사항 사전 점검, 점검 결과 제출\n- 유의 사항: 사실에 근거하여 기재하고 개인정보 및 민감정보 입력 기준 준수\n- 일정: (붙임 참조 또는 추후 안내)",
    attachments: ["점검 계획(안) 1부", "점검 체크리스트 1부"],
  },
  {
    id: "training-plan",
    category: "연수",
    label: "연수 운영 계획",
    subject: "교내 연수 운영 계획(안) 수립",
    details:
      "- 목적: 교원 전문성 신장 및 학교 교육과정 운영 역량 강화\n- 추진 내용: 연수 주제 선정, 강사(내부/외부) 섭외, 운영 방식(대면/원격) 및 자료 준비\n- 협조 요청: 부서별 참석 협조, 연수 장소 및 기자재 준비, 만족도 조사 참여\n- 일정/장소: (추후 안내 또는 붙임 참조)",
    attachments: ["연수 운영 계획(안) 1부", "연수 일정표 1부"],
  },
  {
    id: "training-report",
    category: "연수",
    label: "연수 운영 보고",
    subject: "교내 연수 운영 결과 보고",
    details:
      "- 목적: 교내 연수 운영 결과 공유 및 향후 개선 방향 도출\n- 주요 내용: 연수 개요(일시/대상/주제), 운영 경과, 참여 현황, 만족도 결과 요약\n- 개선 사항: 운영상 애로사항 및 다음 운영 시 보완점\n- 협조 요청: 관련 자료(사진/자료집/만족도 결과) 취합 및 공유",
    attachments: ["연수 운영 결과 보고서 1부", "만족도 조사 결과 1부"],
  },
  {
    id: "entrance-ceremony",
    category: "행사/의전",
    label: "입학식 계획",
    subject: "입학식 운영 계획(안) 수립",
    details:
      "- 목적: 신입생의 안정적인 학교생활 적응 지원 및 원활한 행사 운영\n- 추진 내용: 행사 진행 순서 구성, 환영 및 안내, 안전관리(동선/출입) 및 비상 대응\n- 협조 요청: 담당 부서별 역할 분담, 학부모 안내(주차/출입), 시설 및 방송 장비 점검\n- 일정/장소: (붙임 참조 또는 추후 안내)",
    attachments: ["입학식 운영 계획(안) 1부", "행사 진행 순서(안) 1부"],
  },
  {
    id: "graduation-ceremony",
    category: "행사/의전",
    label: "졸업식 계획",
    subject: "졸업식 운영 계획(안) 수립",
    details:
      "- 목적: 졸업생의 학업 성취를 축하하고 안전하고 품격 있는 행사 운영\n- 추진 내용: 시상 및 졸업장 수여 절차, 좌석/동선 계획, 안전 및 질서 유지, 사진/영상 촬영 안내\n- 협조 요청: 담당 부서별 역할 분담, 학부모 안내, 시설/방송/안전 점검\n- 일정/장소: (붙임 참조 또는 추후 안내)",
    attachments: ["졸업식 운영 계획(안) 1부", "행사 진행 순서(안) 1부"],
  },
  {
    id: "school-year-plan",
    category: "학사/운영",
    label: "학사 운영(연간) 계획",
    subject: "연간 학사 운영 계획(안) 수립",
    details:
      "- 목적: 교육과정 운영의 체계화 및 학교 일정의 예측 가능성 제고\n- 추진 내용: 학기별 주요 행사 및 평가 일정 정리, 학년(군)별 운영 일정 조율\n- 협조 요청: 학년부/부서별 주요 일정 제출, 중복 일정 조정 협조\n- 유의 사항: 교육청 지침 및 학교 사정에 따라 조정 가능",
    attachments: ["연간 학사 일정(안) 1부"],
  },
  {
    id: "semester-plan",
    category: "학사/운영",
    label: "학기말 업무 추진 계획",
    subject: "학기말 업무 추진 계획(안) 수립",
    details:
      "- 목적: 학기말 평가, 생활기록부, 성적 처리, 학급 운영 마무리 업무의 원활한 추진\n- 추진 내용: 업무별 일정 정리, 담당자 지정, 자료 제출 및 점검 절차 안내\n- 협조 요청: 기한 준수 및 관련 자료 제출 협조\n- 유의 사항: 오류/누락 방지를 위해 이중 점검 실시",
    attachments: ["학기말 업무 추진 일정표 1부"],
  },
  {
    id: "class-rep-election",
    category: "학생자치",
    label: "학급 임원 선출 운영",
    subject: "학급 임원 선출 운영 계획(안) 수립",
    details:
      "- 목적: 민주적 의사결정 경험 제공 및 학급 자치 활성화\n- 추진 내용: 후보 등록 및 공약 발표, 선거 절차 안내, 개표 및 결과 공지\n- 협조 요청: 담임교사의 지도 및 공정한 운영, 학생 안전 및 질서 지도\n- 일정: (추후 안내)",
    attachments: ["선거 운영 안내(안) 1부"],
  },
  {
    id: "student-council-election",
    category: "학생자치",
    label: "전교 학생자치 선거 운영",
    subject: "전교 학생자치 선거 운영 계획(안) 수립",
    details:
      "- 목적: 학생자치 활성화 및 민주 시민 역량 함양\n- 추진 내용: 선거관리위원회 구성, 후보 등록/공약, 투표 및 개표 절차\n- 협조 요청: 학년별 참여 독려, 공정성 확보 및 선거 규정 준수\n- 일정: (붙임 참조 또는 추후 안내)",
    attachments: ["선거 운영 계획(안) 1부", "후보 등록 서식 1부"],
  },
  {
    id: "parent-meeting",
    category: "행사/학부모",
    label: "학부모총회 운영",
    subject: "학부모총회 운영 계획(안) 수립",
    details:
      "- 목적: 학교 교육활동 안내 및 학부모와의 소통 강화\n- 추진 내용: 교육과정 및 주요 사업 안내, 학부모회 구성 안내, 질의응답 운영\n- 협조 요청: 자료 준비 및 안내문 배포, 행사 진행 및 안전관리 협조\n- 일정/장소: (추후 안내 또는 붙임 참조)",
    attachments: ["학부모총회 운영 계획(안) 1부", "안내문(안) 1부"],
  },
  {
    id: "curriculum-briefing",
    category: "행사/학부모",
    label: "교육과정 설명회 운영",
    subject: "교육과정 설명회 운영 계획(안) 수립",
    details:
      "- 목적: 학부모의 교육과정 이해 증진 및 가정 연계 교육 지원\n- 추진 내용: 학년별 교육과정 핵심 안내, 평가 및 생활지도 안내, 질의응답\n- 협조 요청: 자료 준비 및 안내, 행사 진행 및 안전관리\n- 일정: (추후 안내)",
    attachments: ["설명회 운영 계획(안) 1부", "안내자료 1부"],
  },
  {
    id: "consulting-week",
    category: "생활/상담",
    label: "상담주간 운영",
    subject: "학생·학부모 상담주간 운영 계획(안) 수립",
    details:
      "- 목적: 학생 성장 지원 및 가정-학교 연계 상담 강화\n- 추진 내용: 상담 일정 편성, 상담 방법(대면/전화/온라인) 안내, 상담 기록 관리\n- 협조 요청: 학년별 상담 일정 제출 및 운영 협조\n- 유의 사항: 개인정보 보호 및 상담 내용 비밀 유지",
    attachments: ["상담주간 운영 계획(안) 1부", "상담 일정표(서식) 1부"],
  },
  {
    id: "bullying-prevention",
    category: "생활/안전",
    label: "학교폭력 예방 교육 운영",
    subject: "학교폭력 예방 교육 운영 계획(안) 수립",
    details:
      "- 목적: 학교폭력 예방 및 안전한 학교문화 조성\n- 추진 내용: 학년별 예방교육 실시, 캠페인 운영, 신고 및 상담 안내\n- 협조 요청: 담임 및 전담교사의 지도, 관련 자료 활용 및 교육 실적 제출\n- 유의 사항: 구체 사례는 개인정보 보호를 위해 비식별 처리",
    attachments: ["예방교육 운영 계획(안) 1부", "교육자료 1부"],
  },
  {
    id: "child-abuse-prevention",
    category: "생활/안전",
    label: "아동학대 예방 및 신고 의무 교육",
    subject: "아동학대 예방 및 신고의무 교육 운영 계획(안)",
    details:
      "- 목적: 아동학대 예방 및 신고 의무 이행 강화\n- 추진 내용: 관련 법령 및 절차 안내, 사례 중심 교육, 신고 체계 및 지원 기관 안내\n- 협조 요청: 교직원 대상 교육 참여 및 이수 확인\n- 유의 사항: 실제 사례 공유 시 개인정보 및 2차 피해 방지 준수",
    attachments: ["교육 운영 계획(안) 1부", "이수 확인 서식 1부"],
  },
  {
    id: "safety-education",
    category: "생활/안전",
    label: "안전교육(연간) 운영",
    subject: "학생 안전교육 운영 계획(연간)(안) 수립",
    details:
      "- 목적: 생활안전·교통안전·재난안전 등 학생 안전 역량 강화\n- 추진 내용: 교육과정 연계 안전교육, 실습 및 훈련(대피/소화기 등) 운영\n- 협조 요청: 학년별 운영 계획 수립 및 실적 제출, 관련 자료 활용\n- 일정: (붙임 참조)",
    attachments: ["안전교육 연간 운영 계획(안) 1부"],
  },
  {
    id: "fire-drill",
    category: "재난/훈련",
    label: "화재 대피훈련 실시",
    subject: "화재 대피훈련 실시 계획(안) 수립",
    details:
      "- 목적: 화재 발생 시 대피 요령 숙지 및 안전 의식 제고\n- 추진 내용: 대피 경로 안내, 훈련 방송 및 신속 대피, 훈련 후 피드백\n- 협조 요청: 학급별 지도 및 대피 질서 유지, 취약 학생 지원\n- 유의 사항: 실제 상황을 가장하되 안전을 최우선으로 운영",
    attachments: ["대피훈련 계획(안) 1부", "대피 경로 안내도 1부"],
  },
  {
    id: "earthquake-drill",
    category: "재난/훈련",
    label: "지진 대피훈련 실시",
    subject: "지진 대피훈련 실시 계획(안) 수립",
    details:
      "- 목적: 지진 발생 시 행동요령 숙지 및 신속한 대피 훈련\n- 추진 내용: 책상 아래 대피, 대피로 이동, 운동장 집결 및 인원 점검\n- 협조 요청: 학급별 지도 및 안전 확보\n- 유의 사항: 행동요령 사전 교육 실시",
    attachments: ["대피훈련 계획(안) 1부"],
  },
  {
    id: "fine-dust",
    category: "보건",
    label: "미세먼지 대응 운영",
    subject: "미세먼지 대응 운영 방안 안내",
    details:
      "- 목적: 미세먼지 고농도 시 학생 건강 보호\n- 추진 내용: 실외활동 조정 기준 안내, 교실 환기 및 공기질 관리, 보건실 대응\n- 협조 요청: 학급별 안내 및 실외활동 조정 협조\n- 유의 사항: 기상 및 관련 지침에 따라 탄력 운영",
    attachments: ["미세먼지 대응 안내자료 1부"],
  },
  {
    id: "health-check",
    category: "보건",
    label: "학생 건강검진 안내",
    subject: "학생 건강검진 실시 안내(협조 요청)",
    details:
      "- 목적: 학생 건강 상태 확인 및 예방적 건강관리\n- 추진 내용: 대상자 안내, 검진 기관 및 절차 안내, 결과 제출 방법 안내\n- 협조 요청: 가정 내 검진 참여 및 결과 회신 협조\n- 유의 사항: 개인정보 보호 및 서류 보관 기준 준수",
    attachments: ["건강검진 안내문(안) 1부", "제출 서식 1부"],
  },
  {
    id: "dental-check",
    category: "보건",
    label: "학생 구강검진 안내",
    subject: "학생 구강검진 실시 안내(협조 요청)",
    details:
      "- 목적: 구강 건강 관리 및 예방교육 강화\n- 추진 내용: 검진 일정 및 절차 안내, 결과 제출 안내, 구강보건 교육 병행\n- 협조 요청: 가정 내 검진 참여 및 결과 회신 협조\n- 유의 사항: 개인정보 보호 준수",
    attachments: ["구강검진 안내문(안) 1부"],
  },
  {
    id: "vision-hearing",
    category: "보건",
    label: "시력/청력 검사 운영",
    subject: "학생 시력·청력 검사 운영 계획(안)",
    details:
      "- 목적: 학생 건강 상태 조기 확인 및 상담 연계\n- 추진 내용: 검사 일정 및 장소 운영, 검사 후 결과 안내 및 상담 연계\n- 협조 요청: 학급별 이동 및 검사 질서 지도\n- 유의 사항: 결과 처리 및 개인정보 보호 준수",
    attachments: ["검사 운영 계획(안) 1부"],
  },
  {
    id: "influenza",
    category: "보건",
    label: "인플루엔자(독감) 예방 안내",
    subject: "인플루엔자 예방을 위한 가정 협조 요청",
    details:
      "- 목적: 계절성 감염병 예방 및 결석 최소화\n- 추진 내용: 예방수칙 안내(손씻기/기침예절), 유증상 시 등교중지 기준 안내\n- 협조 요청: 가정 내 유증상 시 조기 진료 및 학교 알림\n- 기타: 보건당국 지침 준수",
    attachments: ["예방 안내문 1부"],
  },
  {
    id: "nutrition-education",
    category: "급식/보건",
    label: "영양(식생활) 교육 운영",
    subject: "식생활 교육 운영 계획(안)",
    details:
      "- 목적: 건강한 식습관 형성 및 올바른 급식 이해\n- 추진 내용: 학년별 식생활 교육 실시, 알레르기 유의사항 안내, 잔반 줄이기 캠페인\n- 협조 요청: 담임교사의 교육 협조 및 학급 안내\n- 유의 사항: 학생 건강 정보는 개인정보 보호 기준 준수",
    attachments: ["교육 운영 계획(안) 1부", "안내자료 1부"],
  },
  {
    id: "allergy-survey",
    category: "급식/보건",
    label: "급식 알레르기 조사",
    subject: "급식 알레르기 조사 실시(협조 요청)",
    details:
      "- 목적: 학생 알레르기 정보 파악 및 안전한 급식 제공\n- 추진 내용: 조사서 배부 및 회수, 정보 확인 및 반영 절차 안내\n- 협조 요청: 보호자 작성 및 기한 내 제출 협조\n- 유의 사항: 알레르기 정보는 민감정보로 엄격히 관리",
    attachments: ["알레르기 조사서 1부", "작성 안내문 1부"],
  },
  {
    id: "special-ed-plan",
    category: "교육지원",
    label: "특수교육 지원 운영",
    subject: "특수교육대상학생 지원 운영 계획(안)",
    details:
      "- 목적: 특수교육대상학생의 교육적 요구에 맞는 지원 제공\n- 추진 내용: 지원 계획 수립, 협의회 운영, 수업 및 생활 지원, 보호자 소통\n- 협조 요청: 관련 부서 협조 및 지원 기록 관리\n- 유의 사항: 대상 학생 정보는 비공개·비식별 원칙 준수",
    attachments: ["지원 운영 계획(안) 1부"],
  },
  {
    id: "multicultural-support",
    category: "교육지원",
    label: "다문화 학생 지원",
    subject: "다문화 학생 지원 운영 계획(안)",
    details:
      "- 목적: 다문화 학생의 학교 적응 및 학습 지원 강화\n- 추진 내용: 한국어/기초학력 지원, 상담 및 가정 연계, 학교생활 안내 강화\n- 협조 요청: 학년별 대상 학생 지원 협조\n- 유의 사항: 개인 배경 정보는 비식별 처리 및 보호",
    attachments: ["지원 운영 계획(안) 1부"],
  },
  {
    id: "new-student-adaptation",
    category: "학적/생활",
    label: "전입생 적응 지원",
    subject: "전입생 적응 지원 운영 계획(안)",
    details:
      "- 목적: 전입생의 안정적인 학급 적응 및 학습 지원\n- 추진 내용: 기초 정보 안내, 또래 도우미 운영, 상담 및 생활지도\n- 협조 요청: 담임 및 관련 부서 협조\n- 유의 사항: 전입생 개인정보 보호 준수",
    attachments: ["전입생 안내자료(안) 1부"],
  },
  {
    id: "school-uniform",
    category: "생활/안내",
    label: "체육복/복장 안내",
    subject: "학생 복장(체육복 등) 안내 및 협조 요청",
    details:
      "- 목적: 학교생활 질서 유지 및 안전한 활동 지원\n- 추진 내용: 복장 기준 안내, 행사/체육활동 시 유의사항 안내\n- 협조 요청: 가정 내 복장 준비 및 지도 협조\n- 유의 사항: 과도한 꾸밈·안전 위험 요소 자제",
    attachments: ["복장 안내문(안) 1부"],
  },
  {
    id: "device-policy",
    category: "생활/안전",
    label: "스마트기기 사용 규정 안내",
    subject: "스마트기기(휴대전화 등) 사용 규정 안내",
    details:
      "- 목적: 수업 집중 및 안전한 학교생활 환경 조성\n- 추진 내용: 교내 사용 기준 안내, 위반 시 지도 절차 안내\n- 협조 요청: 가정 내 지도 및 학생 준수 협조\n- 유의 사항: 긴급 상황 대응 체계는 별도 안내",
    attachments: ["스마트기기 사용 안내문(안) 1부"],
  },
  {
    id: "privacy-guidance",
    category: "정보/보안",
    label: "개인정보 보호 안내(교직원)",
    subject: "개인정보 보호 및 보안수칙 준수 안내",
    details:
      "- 목적: 개인정보 유출 예방 및 보안 의식 강화\n- 추진 내용: 문서/USB/메일 취급 유의, 비밀번호 관리, 출력물 및 폐기 절차 준수\n- 협조 요청: 각 부서별 점검 및 보안수칙 준수\n- 유의 사항: 민감정보는 최소 수집·최소 이용 원칙 준수",
    attachments: ["개인정보 보호 수칙 1부"],
  },
  {
    id: "info-security-check",
    category: "정보/보안",
    label: "정보보안 점검 실시",
    subject: "정보보안 자체점검 실시 계획(안)",
    details:
      "- 목적: 정보자산 보호 및 보안 취약점 사전 점검\n- 추진 내용: 계정/권한 점검, PC 보안 업데이트, 저장매체 관리, 보안 교육\n- 협조 요청: 교직원 점검표 작성 및 제출, 취약 항목 개선 조치\n- 일정: (붙임 참조 또는 추후 안내)",
    attachments: ["자체점검표 1부", "점검 계획(안) 1부"],
  },
  {
    id: "neis-work",
    category: "교무/행정",
    label: "업무시스템(NEIS 등) 입력 협조",
    subject: "업무시스템 입력 및 자료 제출 협조 요청",
    details:
      "- 목적: 학사 및 행정 업무의 정확한 처리\n- 추진 내용: 입력 대상 항목 안내, 제출 기한 및 검토 절차 안내\n- 협조 요청: 기한 내 입력 및 자료 제출, 오류 발견 시 즉시 수정\n- 유의 사항: 개인정보 및 민감정보 입력 기준 준수",
    attachments: ["입력 안내자료 1부"],
  },
  {
    id: "teacher-duty-roster",
    category: "학사/운영",
    label: "교내 당직/안전지도 배치",
    subject: "교내 안전지도 및 당직 편성(안) 안내",
    details:
      "- 목적: 학생 안전 확보 및 사고 예방\n- 추진 내용: 시간대별 지도 구역 지정, 역할 및 유의사항 안내\n- 협조 요청: 담당자별 근무 준수 및 특이사항 보고\n- 유의 사항: 지도 공백 발생 시 즉시 대체 인력 조정",
    attachments: ["근무 편성표(안) 1부"],
  },
  {
    id: "commute-safety",
    category: "생활/안전",
    label: "등하굣길 안전 지도",
    subject: "등하굣길 안전 지도 강화 협조 요청",
    details:
      "- 목적: 등하굣길 안전사고 예방\n- 추진 내용: 통학로 안전 지도, 교통안전 교육, 위험 구간 안내\n- 협조 요청: 학급별 안전지도 및 가정 내 지도 협조\n- 유의 사항: 학교-가정-지역사회 연계 필요",
    attachments: ["통학로 안전 안내자료 1부"],
  },
  {
    id: "school-zone-campaign",
    category: "생활/안전",
    label: "스쿨존 안전 캠페인",
    subject: "스쿨존 안전 캠페인 운영 계획(안)",
    details:
      "- 목적: 스쿨존 교통안전 의식 제고\n- 추진 내용: 안전 표어 및 캠페인 활동, 안내장 게시, 학생 참여 활동 운영\n- 협조 요청: 학년별 참여 및 지도, 캠페인 자료 준비 협조\n- 일정: (추후 안내)",
    attachments: ["캠페인 운영 계획(안) 1부"],
  },
  {
    id: "library-week",
    category: "교육활동",
    label: "도서관(독서) 행사 운영",
    subject: "독서문화 행사 운영 계획(안)",
    details:
      "- 목적: 학생 독서 습관 형성 및 독서문화 활성화\n- 추진 내용: 독서주간 운영, 추천도서 안내, 독후활동 및 전시\n- 협조 요청: 학급별 참여 안내 및 지도, 자료 준비 협조\n- 일정: (붙임 참조 또는 추후 안내)",
    attachments: ["행사 운영 계획(안) 1부", "활동 안내자료 1부"],
  },
  {
    id: "sports-day",
    category: "행사/체육",
    label: "체육대회(운동회) 운영",
    subject: "체육대회(운동회) 운영 계획(안) 수립",
    details:
      "- 목적: 체육활동을 통한 건강 증진 및 공동체 의식 함양\n- 추진 내용: 종목 구성, 학년별 운영, 안전관리 및 응급 대응 체계 마련\n- 협조 요청: 부서별 역할 분담, 학부모 안내, 시설 및 안전 점검\n- 일정/장소: (붙임 참조 또는 추후 안내)",
    attachments: ["운영 계획(안) 1부", "종목 및 진행표(안) 1부"],
  },
  {
    id: "school-trip-overnight",
    category: "체험/안전",
    label: "수련활동 운영",
    subject: "수련활동 운영 계획(안) 보고",
    details:
      "- 목적: 공동체 활동을 통한 인성 및 자율성 함양\n- 추진 내용: 프로그램 구성, 안전교육, 인솔 및 생활지도 계획 수립\n- 협조 요청: 사전 안내 및 동의서 회수, 안전관리 협조\n- 유의 사항: 일정/장소 미확정 시 임의로 기재하지 말고 '추후 안내' 처리",
    attachments: ["운영 계획(안) 1부", "안전교육 자료 1부", "동의서(서식) 1부"],
  },
  {
    id: "club-activity",
    category: "교육활동",
    label: "동아리 운영",
    subject: "학생 동아리 운영 계획(안) 수립",
    details:
      "- 목적: 학생의 소질·적성 계발 및 자율적 참여 확대\n- 추진 내용: 동아리 구성, 운영 일정, 안전 및 지도 계획\n- 협조 요청: 담당교사 지도 및 운영 실적 정리\n- 일정: (붙임 참조)",
    attachments: ["동아리 운영 계획(안) 1부"],
  },
  {
    id: "school-evaluation",
    category: "점검/평가",
    label: "학교 자체평가 추진",
    subject: "학교 자체평가 추진 계획(안) 수립",
    details:
      "- 목적: 학교 교육활동 성과 점검 및 개선 과제 도출\n- 추진 내용: 평가 영역 및 지표 안내, 자료 수집 및 분석, 결과 공유\n- 협조 요청: 부서별 자료 제출 및 협의 참여\n- 일정: (붙임 참조 또는 추후 안내)",
    attachments: ["자체평가 추진 계획(안) 1부", "평가 지표(안) 1부"],
  },
  {
    id: "classroom-observation",
    category: "수업/장학",
    label: "수업 나눔(공개) 운영",
    subject: "수업 나눔(공개) 운영 계획(안)",
    details:
      "- 목적: 수업 전문성 향상 및 동료장학 활성화\n- 추진 내용: 공개수업 일정 조율, 참관 및 피드백 운영, 자료 공유\n- 협조 요청: 참여 교원 일정 협조 및 자료 준비\n- 유의 사항: 학생 개인정보 및 수업 촬영 기준 준수",
    attachments: ["운영 계획(안) 1부"],
  },
  {
    id: "research-lesson",
    category: "수업/장학",
    label: "수업연구회 운영",
    subject: "수업연구회 운영 계획(안) 수립",
    details:
      "- 목적: 교육과정 재구성 및 수업 개선을 위한 연구 활동 추진\n- 추진 내용: 연구 주제 선정, 회의 운영, 결과 공유 및 자료 제작\n- 협조 요청: 참여 교원 일정 협조 및 자료 취합\n- 일정: (추후 안내)",
    attachments: ["운영 계획(안) 1부"],
  },
  {
    id: "teacher-training-ict",
    category: "연수",
    label: "디지털/AI 활용 연수 운영",
    subject: "디지털·AI 활용 역량 강화 연수 운영 계획(안)",
    details:
      "- 목적: 수업 및 행정에서의 디지털 도구 활용 역량 강화\n- 추진 내용: 기초 활용 교육, 사례 공유, 실습 중심 운영\n- 협조 요청: 참석 협조 및 실습 환경(기기/계정) 준비\n- 일정: (추후 안내)",
    attachments: ["연수 운영 계획(안) 1부", "실습 자료 1부"],
  },
  {
    id: "training-satisfaction",
    category: "연수",
    label: "연수 만족도 조사",
    subject: "연수 만족도 조사 실시(협조 요청)",
    details:
      "- 목적: 연수 운영 품질 개선을 위한 의견 수렴\n- 추진 내용: 설문 문항 안내, 참여 방법 및 기한 안내, 결과 분석 및 공유\n- 협조 요청: 전 교직원 설문 참여 협조\n- 유의 사항: 응답은 익명 또는 비식별 처리 원칙 준수",
    attachments: ["만족도 조사 문항(안) 1부"],
  },
  {
    id: "teacher-meeting",
    category: "교무/회의",
    label: "교직원 회의 운영",
    subject: "교직원 회의 운영 계획(안) 및 안건 제출 협조",
    details:
      "- 목적: 학교 주요 현안 공유 및 의사결정의 효율성 제고\n- 추진 내용: 안건 수합, 자료 사전 공유, 회의 진행 및 결과 정리\n- 협조 요청: 부서별 안건 및 자료 제출, 회의 참석 협조\n- 일정: (추후 안내)",
    attachments: ["안건 제출 서식 1부"],
  },
  {
    id: "committee-meeting",
    category: "위원회",
    label: "각종 위원회 개최",
    subject: "위원회 개최 계획(안) 수립 및 협조 요청",
    details:
      "- 목적: 관련 안건의 심의·의결을 위한 위원회 운영\n- 추진 내용: 위원 구성 확인, 회의 일정 조율, 자료 준비 및 회의록 작성\n- 협조 요청: 안건 제출 및 자료 준비, 위원 참석 협조\n- 유의 사항: 회의 자료는 보안 기준 준수",
    attachments: ["회의자료(안) 1부", "회의록 서식 1부"],
  },
  {
    id: "school-meal-plan",
    category: "급식/운영",
    label: "급식 운영 계획",
    subject: "학교급식 운영 계획(안) 수립",
    details:
      "- 목적: 안전하고 위생적인 급식 운영 및 학생 건강 증진\n- 추진 내용: 위생·안전 점검, 알레르기 관리, 급식 지도 및 식생활 교육 연계\n- 협조 요청: 학급별 급식지도 협조 및 특이사항 보고\n- 일정: (붙임 참조)",
    attachments: ["급식 운영 계획(안) 1부"],
  },
  {
    id: "meal-safety-check",
    category: "급식/운영",
    label: "급식 위생 점검",
    subject: "급식 위생·안전 점검 실시(협조 요청)",
    details:
      "- 목적: 식중독 예방 및 위생관리 강화\n- 추진 내용: 점검 항목 안내, 점검 일정 운영, 개선 조치 및 결과 보고\n- 협조 요청: 관련 부서 점검 참여 및 개선 사항 이행\n- 일정: (추후 안내)",
    attachments: ["점검표 1부"],
  },
  {
    id: "facility-safety-check",
    category: "시설/안전",
    label: "시설물 안전점검",
    subject: "학교 시설물 안전점검 실시 계획(안)",
    details:
      "- 목적: 시설물 안전사고 예방 및 안전한 교육환경 조성\n- 추진 내용: 점검 대상 및 항목 선정, 점검 실시, 보수·보강 계획 수립\n- 협조 요청: 점검 시 출입 협조 및 사용 제한 안내 준수\n- 유의 사항: 위험 발견 시 즉시 사용 중지 및 보고",
    attachments: ["안전점검 계획(안) 1부", "점검표 1부"],
  },
  {
    id: "classroom-environment",
    category: "시설/환경",
    label: "교실 환경정비",
    subject: "교실 및 공용공간 환경정비 실시(협조 요청)",
    details:
      "- 목적: 쾌적하고 안전한 교육환경 조성\n- 추진 내용: 정리정돈 기준 안내, 게시물 및 비품 정비, 안전 위험 요소 점검\n- 협조 요청: 학급별 정비 실시 및 결과 확인\n- 일정: (추후 안내)",
    attachments: ["환경정비 체크리스트 1부"],
  },
  {
    id: "recycling-campaign",
    category: "환경",
    label: "자원순환(분리수거) 캠페인",
    subject: "자원순환(분리수거) 실천 캠페인 운영 계획(안)",
    details:
      "- 목적: 환경보호 실천 및 올바른 분리배출 습관 형성\n- 추진 내용: 분리수거 안내, 학급 참여 활동, 홍보 자료 게시\n- 협조 요청: 학급별 참여 및 지도\n- 일정: (추후 안내)",
    attachments: ["캠페인 안내자료 1부"],
  },
  {
    id: "school-festival",
    category: "행사/문화",
    label: "학교 축제 운영",
    subject: "학교 축제 운영 계획(안) 수립",
    details:
      "- 목적: 학생 참여 중심의 문화·예술 활동 활성화\n- 추진 내용: 프로그램 구성, 부스 운영, 안전관리 및 질서 유지, 가정 안내\n- 협조 요청: 부서별 역할 분담 및 운영 협조\n- 유의 사항: 안전 및 개인정보(촬영/공유) 기준 준수",
    attachments: ["운영 계획(안) 1부", "프로그램 구성(안) 1부"],
  },
  {
    id: "career-day",
    category: "진로/체험",
    label: "진로체험 운영",
    subject: "진로체험활동 운영 계획(안) 수립",
    details:
      "- 목적: 학생의 진로 인식 및 직업 세계 이해 증진\n- 추진 내용: 체험 프로그램 구성, 안전교육, 운영 인력 및 동선 계획\n- 협조 요청: 학급별 참여 및 지도, 사전 안내 협조\n- 일정: (붙임 참조 또는 추후 안내)",
    attachments: ["운영 계획(안) 1부", "안전교육 자료 1부"],
  },
  {
    id: "science-week",
    category: "교육활동",
    label: "과학의 날 행사 운영",
    subject: "과학의 날 행사 운영 계획(안) 수립",
    details:
      "- 목적: 과학적 탐구심 함양 및 과학문화 확산\n- 추진 내용: 체험 부스 운영, 탐구 활동, 작품 전시\n- 협조 요청: 학급별 참여 및 안전 지도, 자료 준비 협조\n- 일정: (추후 안내)",
    attachments: ["행사 운영 계획(안) 1부"],
  },
  {
    id: "math-day",
    category: "교육활동",
    label: "수학체험 행사 운영",
    subject: "수학체험 행사 운영 계획(안) 수립",
    details:
      "- 목적: 수학 흥미 유발 및 문제해결력 신장\n- 추진 내용: 체험 활동 및 게임, 학년별 수준 고려 프로그램 운영\n- 협조 요청: 학급별 참여 및 지도, 운영 인력 협조\n- 일정: (추후 안내)",
    attachments: ["행사 운영 계획(안) 1부"],
  },
  {
    id: "art-exhibition",
    category: "교육활동",
    label: "미술 작품 전시 운영",
    subject: "학생 미술 작품 전시 운영 계획(안)",
    details:
      "- 목적: 학생 예술 표현 활동 성과 공유 및 문화 감수성 향상\n- 추진 내용: 전시 공간 구성, 작품 수합 및 설치, 관람 안내\n- 협조 요청: 학급별 작품 제출 및 설치 협조\n- 유의 사항: 작품에 포함된 개인정보 노출 주의",
    attachments: ["전시 운영 계획(안) 1부"],
  },
  {
    id: "music-concert",
    category: "행사/문화",
    label: "음악회(발표회) 운영",
    subject: "학생 발표회(음악회) 운영 계획(안) 수립",
    details:
      "- 목적: 학생의 예술적 성장 지원 및 성과 공유\n- 추진 내용: 프로그램 구성, 리허설 운영, 안전 및 질서 유지\n- 협조 요청: 담당 부서별 역할 분담 및 학부모 안내\n- 일정: (추후 안내 또는 붙임 참조)",
    attachments: ["운영 계획(안) 1부", "프로그램(안) 1부"],
  },
  {
    id: "textbook-collection",
    category: "학사/운영",
    label: "교과서 배부/회수",
    subject: "교과서 배부 및 회수 운영(협조 요청)",
    details:
      "- 목적: 교과서 배부·회수의 정확한 처리\n- 추진 내용: 배부/회수 일정 안내, 훼손·분실 처리 기준 안내\n- 협조 요청: 학급별 수량 점검 및 명단 확인, 기한 준수\n- 유의 사항: 분실·훼손 발생 시 즉시 보고",
    attachments: ["배부/회수 일정 안내 1부"],
  },
  {
    id: "lost-found",
    category: "생활/안내",
    label: "분실물 관리 안내",
    subject: "분실물 관리 및 처리 절차 안내",
    details:
      "- 목적: 분실물의 효율적 관리 및 학생 생활지도 지원\n- 추진 내용: 분실물 보관 장소 및 기간 안내, 처리 절차 안내\n- 협조 요청: 학급별 안내 및 분실물 발생 시 보고 협조\n- 유의 사항: 개인정보가 포함된 물품은 별도 보관",
    attachments: ["분실물 처리 안내 1부"],
  },
  {
    id: "school-bus",
    category: "생활/안전",
    label: "통학버스 안전 운영",
    subject: "통학버스 안전 운영 협조 요청",
    details:
      "- 목적: 통학버스 이용 학생의 안전 확보\n- 추진 내용: 승하차 질서 지도, 안전벨트 착용, 비상 상황 대응 체계 안내\n- 협조 요청: 보호자 및 학생 준수 협조, 학급별 안내\n- 유의 사항: 안전수칙 위반 시 지도 절차 안내",
    attachments: ["통학버스 안전수칙 안내문 1부"],
  },
  {
    id: "emergency-contact-update",
    category: "학적/생활",
    label: "비상연락망 정비",
    subject: "학생 비상연락망 정비 및 제출 협조 요청",
    details:
      "- 목적: 긴급 상황 발생 시 신속한 연락체계 구축\n- 추진 내용: 연락처 확인 및 변경 사항 반영, 제출 방법 안내\n- 협조 요청: 보호자 연락처 확인 및 기한 내 제출\n- 유의 사항: 수집된 정보는 목적 외 사용 금지 및 안전하게 보관",
    attachments: ["비상연락망 제출 서식 1부"],
  },
  {
    id: "attendance-guidance",
    category: "교무/학적",
    label: "출결 처리 기준 안내",
    subject: "출결 처리 기준 안내 및 협조 요청",
    details:
      "- 목적: 출결 처리의 공정성 및 일관성 확보\n- 추진 내용: 결석/지각/조퇴/결과 처리 기준 안내, 증빙서류 처리 절차 안내\n- 협조 요청: 담임교사의 기준 준수 및 학부모 안내\n- 유의 사항: 증빙 서류는 개인정보 보호 기준 준수",
    attachments: ["출결 처리 기준 안내자료 1부"],
  },
  {
    id: "grades-evaluation",
    category: "평가",
    label: "평가 운영(학기) 계획",
    subject: "학기 평가 운영 계획(안) 수립",
    details:
      "- 목적: 공정하고 신뢰도 높은 학생 평가 운영\n- 추진 내용: 평가 계획 수립 및 공유, 평가 후 피드백 제공, 결과 처리 및 기록\n- 협조 요청: 평가 관련 자료 제출 및 일정 준수\n- 유의 사항: 평가 관련 보안 및 공정성 준수",
    attachments: ["평가 운영 계획(안) 1부"],
  },
  {
    id: "performance-assessment",
    category: "평가",
    label: "수행평가 운영(안내)",
    subject: "수행평가 운영 안내 및 협조 요청",
    details:
      "- 목적: 수업과 연계된 수행평가의 공정한 운영\n- 추진 내용: 평가 기준 및 방법 안내, 과제 제출 및 피드백 절차 안내\n- 협조 요청: 학생·학부모 이해 및 협조\n- 유의 사항: 평가 일정은 학교 운영에 따라 변경 가능",
    attachments: ["수행평가 안내자료(안) 1부"],
  },
  {
    id: "makeup-learning",
    category: "학사/운영",
    label: "결손보충(보충학습) 운영",
    subject: "결손보충(보충학습) 운영 계획(안)",
    details:
      "- 목적: 학생 학습 결손 최소화 및 기초학력 지원\n- 추진 내용: 대상 학생 선정(비식별 기준 준수), 운영 방식 및 자료 준비\n- 협조 요청: 관련 교원의 지도 협조 및 운영 기록 정리\n- 유의 사항: 학생 개인별 정보는 보호 원칙 준수",
    attachments: ["운영 계획(안) 1부"],
  },
  {
    id: "summer-winter-break",
    category: "학사/운영",
    label: "방학 중 생활지도 안내",
    subject: "방학 중 생활지도 안내 및 가정 협조 요청",
    details:
      "- 목적: 방학 중 학생 안전 및 생활지도 강화\n- 추진 내용: 안전수칙 및 생활규칙 안내, 학습 및 독서 안내, 온라인 안전 안내\n- 협조 요청: 가정 내 지도 및 안전 관리 협조\n- 유의 사항: 긴급 상황 시 연락체계 안내(별도)",
    attachments: ["방학 중 생활지도 안내문(안) 1부"],
  },
  {
    id: "winter-school",
    category: "학사/운영",
    label: "방학 중 학교 프로그램 운영",
    subject: "방학 중 학교 프로그램 운영 계획(안)",
    details:
      "- 목적: 방학 중 교육활동 지원 및 돌봄 기능 보완\n- 추진 내용: 프로그램 구성, 운영 인력 배치, 안전관리 및 출결 관리\n- 협조 요청: 참가 신청 및 운영 협조\n- 일정: (붙임 참조 또는 추후 안내)",
    attachments: ["운영 계획(안) 1부", "프로그램 안내문(안) 1부"],
  },
  {
    id: "school-trip-day",
    category: "체험/안전",
    label: "교내·외 체험 프로그램 운영",
    subject: "체험 프로그램 운영 계획(안)",
    details:
      "- 목적: 교육과정 연계 체험학습 운영\n- 추진 내용: 체험 활동 구성, 안전교육, 인솔 및 응급 대응 계획\n- 협조 요청: 운영 인력 협조 및 학생 안전 지도\n- 일정/장소: (추후 안내)",
    attachments: ["운영 계획(안) 1부"],
  },
  {
    id: "campus-clean",
    category: "환경",
    label: "교내 환경정화 활동",
    subject: "교내 환경정화 활동 운영 계획(안)",
    details:
      "- 목적: 쾌적한 학교 환경 조성 및 환경보호 실천\n- 추진 내용: 활동 구역 지정, 안전 지도, 분리수거 및 정리정돈\n- 협조 요청: 학급별 참여 및 안전 지도\n- 일정: (추후 안내)",
    attachments: ["운영 계획(안) 1부"],
  },
  {
    id: "field-safety-inspection",
    category: "체험/안전",
    label: "현장학습 사전 안전점검",
    subject: "현장체험학습 사전 안전점검 실시(협조 요청)",
    details:
      "- 목적: 체험학습 운영 전 안전 위험요소 사전 확인\n- 추진 내용: 이동 경로 및 장소 점검, 비상대응 계획 확인, 안전교육 자료 점검\n- 협조 요청: 점검 참여 및 결과 공유 협조\n- 일정: (추후 안내)",
    attachments: ["안전점검표 1부"],
  },
  {
    id: "school-anniversary",
    category: "행사/의전",
    label: "개교기념일 행사(안내)",
    subject: "개교기념일 운영 안내 및 협조 요청",
    details:
      "- 목적: 학교 역사와 전통을 기념하고 공동체 의식 함양\n- 추진 내용: 기념 행사 운영(간소화 가능), 학급 활동 안내\n- 협조 요청: 학급별 안내 및 운영 협조\n- 유의 사항: 행사 운영은 학교 여건에 따라 조정",
    attachments: ["운영 안내자료 1부"],
  },
  {
    id: "evaluation-plan-grade",
    category: "평가",
    label: "학년(군) 평가계획 수립",
    subject: "학년(군) 평가계획 수립 및 제출 협조 요청",
    details:
      "- 목적: 학년(군) 평가 운영의 일관성 확보 및 공정한 평가 시행\n- 추진 내용: 평가 목표 및 내용 요소 정리, 평가 방법(지필/수행) 및 시기 협의, 평가 기준·루브릭 마련\n- 협조 요청: 학년(군)별 협의 후 계획서 제출, 변경 사항 발생 시 즉시 공유\n- 유의 사항: 평가 공정성·보안 준수, 학생·학부모 안내는 학교 방침에 따름",
    attachments: ["평가계획(서식) 1부", "평가 기준안(루브릭) 1부"],
  },
  {
    id: "evaluation-plan-subject",
    category: "평가",
    label: "교과(전담) 평가계획 협의",
    subject: "교과(전담) 평가계획 협의 및 운영 안내",
    details:
      "- 목적: 교과 평가의 타당도·신뢰도 제고\n- 추진 내용: 성취기준 기반 평가 내용 선정, 수행평가 과제 및 채점 기준 협의, 피드백 방안 마련\n- 협조 요청: 교과 담당교사 협의 참여 및 자료 공유\n- 유의 사항: 과제 난이도·분량 적정성 검토, 과도한 가정 과제 지양",
    attachments: ["평가계획(안) 1부"],
  },
  {
    id: "evaluation-security",
    category: "평가",
    label: "평가 보안 및 공정성 유의",
    subject: "평가 보안 및 공정성 준수 안내",
    details:
      "- 목적: 평가의 공정성 확보 및 평가자료 유출 방지\n- 추진 내용: 평가자료 보관·출력·폐기 절차 안내, 채점 기준 통일, 이의신청 처리 절차 안내\n- 협조 요청: 담당교사 보안수칙 준수 및 점검표 제출(필요 시)\n- 유의 사항: 학생 개인정보 포함 자료 취급 시 보안 기준 준수",
    attachments: ["평가 보안수칙 안내 1부"],
  },
  {
    id: "evaluation-feedback",
    category: "평가",
    label: "평가 결과 처리 및 피드백",
    subject: "평가 결과 처리 및 피드백 운영 안내",
    details:
      "- 목적: 평가 결과의 교육적 활용 강화\n- 추진 내용: 결과 분석 및 환류, 학생 피드백 제공 방식 안내, 보충 지도 계획 수립\n- 협조 요청: 결과 분석 자료 제출 및 협의 참여\n- 유의 사항: 결과 공개 범위 및 개인정보 보호 기준 준수",
    attachments: ["결과 분석 양식 1부", "보충 지도 계획(서식) 1부"],
  },
  {
    id: "curriculum-annual",
    category: "교육과정",
    label: "학교교육과정 편성·운영 계획",
    subject: "학교교육과정 편성·운영 계획(안) 수립 및 협조 요청",
    details:
      "- 목적: 학교교육과정의 체계적 운영 및 학년 간 연계 강화\n- 추진 내용: 교육과정 편성(시수) 검토, 학년(군) 운영 방향 설정, 창의적 체험활동 운영 계획 수립\n- 협조 요청: 학년(군)·부서별 운영 계획 및 자료 제출\n- 유의 사항: 교육청 지침 및 학교 여건 반영, 변경 가능성 사전 안내",
    attachments: ["학교교육과정 편성·운영 계획(안) 1부"],
  },
  {
    id: "curriculum-meeting",
    category: "교육과정",
    label: "교육과정 협의회 운영",
    subject: "교육과정 협의회 개최 및 안건 제출 협조",
    details:
      "- 목적: 교육과정 운영 현안 공유 및 개선 방안 협의\n- 추진 내용: 안건 수합, 사전 자료 공유, 협의 결과 정리 및 후속 조치 안내\n- 협조 요청: 부서별 안건 및 자료 제출, 참석 협조\n- 유의 사항: 회의 자료 보안 및 개인정보 보호 준수",
    attachments: ["안건 제출 서식 1부", "회의자료(안) 1부"],
  },
  {
    id: "curriculum-reconstruction",
    category: "교육과정",
    label: "교육과정 재구성 운영",
    subject: "교육과정 재구성 운영 계획(안) 수립",
    details:
      "- 목적: 학생 중심 수업 실현을 위한 교육과정 재구성 및 수업 개선\n- 추진 내용: 성취기준 분석, 단원 재구성 및 프로젝트/융합 수업 설계, 평가 연계 방안 마련\n- 협조 요청: 학년(군)별 재구성 계획 제출 및 사례 공유\n- 유의 사항: 학생 부담 과중 방지, 학교 여건 고려하여 탄력 운영",
    attachments: ["재구성 운영 계획(안) 1부", "수업안(서식) 1부"],
  },
  {
    id: "curriculum-operation-check",
    category: "교육과정",
    label: "교육과정 운영 점검 및 환류",
    subject: "교육과정 운영 점검 및 환류 계획(안) 수립",
    details:
      "- 목적: 교육과정 운영의 질 관리 및 개선 과제 도출\n- 추진 내용: 운영 점검 항목 설정, 수업/평가/기록 연계 점검, 결과 환류 및 개선 계획 수립\n- 협조 요청: 관련 자료 제출 및 점검 참여\n- 일정: (붙임 참조 또는 추후 안내)",
    attachments: ["점검 계획(안) 1부", "점검표 1부"],
  },
  {
    id: "curriculum-guidance-parent",
    category: "교육과정",
    label: "교육과정 가정 안내(협조)",
    subject: "교육과정 운영 안내 및 가정 협조 요청",
    details:
      "- 목적: 교육과정 운영에 대한 가정의 이해 증진 및 협력 강화\n- 추진 내용: 학기 교육과정 운영 방향, 평가 및 생활지도 안내, 가정 연계 활동 안내(필요 시)\n- 협조 요청: 안내사항 확인 및 가정 내 협조\n- 유의 사항: 학생 개인정보 포함 자료 공유 금지, 문의는 담임/담당부서로 안내",
    attachments: ["가정 안내문(안) 1부"],
  },
  {
    id: "basic-literacy-plan",
    category: "교육과정",
    label: "기초학력 지원 운영",
    subject: "기초학력 지원 운영 계획(안) 수립",
    details:
      "- 목적: 기초학력 보장 및 학습 결손 예방\n- 추진 내용: 지원 대상 파악(비식별 원칙 준수), 지원 프로그램 운영, 수업·평가·기록 연계, 결과 점검\n- 협조 요청: 담임 및 관련 교원의 운영 협조, 지원 실적 및 결과 제출\n- 유의 사항: 대상 학생 정보는 보호 원칙 준수",
    attachments: ["지원 운영 계획(안) 1부", "운영 기록(서식) 1부"],
  },
  {
    id: "reading-curriculum",
    category: "교육과정",
    label: "독서교육 운영 계획",
    subject: "독서교육 운영 계획(안) 수립",
    details:
      "- 목적: 학생 독서역량 신장 및 학교 독서문화 조성\n- 추진 내용: 학년별 독서활동 운영, 도서관 활용 수업, 독후활동 및 행사 연계\n- 협조 요청: 학급별 운영 협조 및 활동 실적 제출\n- 일정: (붙임 참조 또는 추후 안내)",
    attachments: ["독서교육 운영 계획(안) 1부"],
  },
  {
    id: "curriculum-document-submit",
    category: "교육과정",
    label: "교육과정 관련 서류 제출 협조",
    subject: "교육과정 관련 서류 제출 협조 요청",
    details:
      "- 목적: 교육과정 운영 자료의 체계적 관리 및 보고의 정확성 확보\n- 추진 내용: 제출 대상 및 기한 안내, 서류 양식 및 작성 기준 안내, 제출 후 확인 절차 운영\n- 협조 요청: 기한 내 제출 및 오류/누락 방지 협조\n- 유의 사항: 개인정보 포함 자료는 비식별 처리 또는 보안 채널로 제출",
    attachments: ["제출 서식 1부", "작성 기준 안내 1부"],
  },
  {
    id: "school-council-meeting",
    category: "위원회",
    label: "학교운영위원회 개최",
    subject: "학교운영위원회 개최 계획(안) 및 안건 제출 협조 요청",
    details:
      "- 목적: 학교운영위원회 심의·의결 안건 처리 및 학교 운영의 투명성 확보\n- 추진 내용: 회의 일정 및 장소(또는 비대면 방식) 안내, 안건 수합 및 자료 사전 공유, 회의 진행 및 회의록 작성\n- 협조 요청: 관련 부서 안건 및 자료 제출, 위원 참석 협조\n- 유의 사항: 회의자료 보안 및 개인정보 보호 준수",
    attachments: ["안건 제출 서식 1부", "회의자료(안) 1부", "회의록 서식 1부"],
  },
  {
    id: "school-council-result",
    category: "위원회",
    label: "학교운영위원회 결과 보고",
    subject: "학교운영위원회 심의 결과 보고",
    details:
      "- 목적: 위원회 심의 결과의 공유 및 후속 조치 이행\n- 주요 내용: 개최 개요(일시/참석), 심의 안건 및 결과(가결/부결/수정), 후속 조치 계획\n- 협조 요청: 관련 부서 후속 조치 이행 및 추진 경과 공유\n- 유의 사항: 개인정보 포함 내용은 비식별 처리",
    attachments: ["회의록(사본) 1부", "심의 결과 요약 1부"],
  },
  {
    id: "committee-attendance-request",
    category: "위원회",
    label: "위원회 위원 위촉/참석 협조",
    subject: "위원회 위원 위촉(또는 참석) 협조 요청",
    details:
      "- 목적: 위원회 구성 및 원활한 운영\n- 추진 내용: 위원 구성 기준 안내, 위촉장(또는 참석 요청) 발송, 회의 일정 안내\n- 협조 요청: 해당자 참여 및 일정 조율 협조\n- 유의 사항: 위원 정보는 목적 외 사용 금지",
    attachments: ["위원 위촉(요청) 서식 1부"],
  },
  {
    id: "budget-plan",
    category: "행정/예산",
    label: "학교회계 예산 편성",
    subject: "학교회계 예산 편성(안) 수립 및 자료 제출 협조",
    details:
      "- 목적: 학교회계 예산 편성의 적정성 및 사업 추진의 효율성 확보\n- 추진 내용: 부서별 사업 계획 및 소요 예산 산정, 우선순위 조정, 예산(안) 취합 및 검토\n- 협조 요청: 부서별 예산 요구서 및 근거 자료 제출, 기한 준수\n- 유의 사항: 단가·산출 근거를 명확히 하고 중복 편성 방지",
    attachments: ["예산요구서(서식) 1부", "사업 계획서(서식) 1부"],
  },
  {
    id: "budget-supplementary",
    category: "행정/예산",
    label: "추가경정예산(추경) 편성",
    subject: "추가경정예산(추경) 편성(안) 수립 및 협조 요청",
    details:
      "- 목적: 사업 변경 및 신규 소요 발생에 따른 예산 조정\n- 추진 내용: 변경 사유 및 산출 근거 확인, 예산 조정(안) 취합, 관련 절차 안내\n- 협조 요청: 관련 부서 변경 내용 및 근거 자료 제출\n- 유의 사항: 절차(심의/보고)는 학교 운영 규정 및 지침에 따름",
    attachments: ["추경 요구서(서식) 1부", "산출 근거 자료 1부"],
  },
  {
    id: "budget-settlement",
    category: "행정/예산",
    label: "학교회계 결산(정산) 보고",
    subject: "학교회계 결산(정산) 자료 제출 협조 요청",
    details:
      "- 목적: 회계 결산의 정확성 확보 및 감사 대응\n- 추진 내용: 집행 내역 점검, 증빙서류 확인, 정산 자료 취합\n- 협조 요청: 부서별 집행 증빙 및 정산 자료 제출\n- 유의 사항: 증빙 누락 방지 및 개인정보 포함 서류 보안 준수",
    attachments: ["정산 자료 제출 목록 1부", "정산서(서식) 1부"],
  },
  {
    id: "purchase-request",
    category: "행정/구매",
    label: "물품 구입 요청",
    subject: "물품 구입(또는 제작) 요청 및 협조",
    details:
      "- 목적: 교육활동 및 학교 운영에 필요한 물품의 적기 확보\n- 추진 내용: 품목 및 규격 확인, 수량·단가 산정, 구입 절차 진행\n- 협조 요청: 필요 물품 목록 및 규격 제출, 검수 협조\n- 유의 사항: 중복 구매 방지 및 예산 범위 내 집행",
    attachments: ["물품 구입 요청서(서식) 1부", "품목·규격 목록 1부"],
  },
  {
    id: "service-contract",
    category: "행정/구매",
    label: "용역(위탁) 운영 요청",
    subject: "용역(위탁) 운영 계획(안) 및 협조 요청",
    details:
      "- 목적: 전문 용역의 효율적 운영 및 안전·품질 확보\n- 추진 내용: 과업 범위 및 일정 정리, 계약 절차 진행, 안전 및 개인정보 처리 기준 안내\n- 협조 요청: 과업 요구사항 및 운영 협조, 결과물 검수 참여\n- 유의 사항: 개인정보 처리 시 위탁계약 및 보안수칙 준수",
    attachments: ["과업지시서(안) 1부", "운영 계획(안) 1부"],
  },
  {
    id: "business-trip",
    category: "인사/복무",
    label: "출장(복무) 협조",
    subject: "출장(복무) 처리 및 업무 인수인계 협조 요청",
    details:
      "- 목적: 출장 기간 중 업무 공백 최소화\n- 추진 내용: 출장 일정 및 대체 업무 안내, 결재 및 민원 대응 체계 공유\n- 협조 요청: 관련 업무 대행 및 인수인계 협조\n- 유의 사항: 구체 일정/장소는 임의로 기재하지 말고 필요 시 추후 안내",
    attachments: ["업무 인수인계서(서식) 1부"],
  },
  {
    id: "leave-guidance",
    category: "인사/복무",
    label: "연가/병가 등 복무 처리 안내",
    subject: "연가/병가 등 복무 처리 안내 및 협조 요청",
    details:
      "- 목적: 복무 처리의 적정성 및 업무 연속성 확보\n- 추진 내용: 신청 절차 및 기준 안내, 대체업무 지정 및 인수인계 안내\n- 협조 요청: 기한 내 신청 및 인수인계 협조\n- 유의 사항: 복무 관련 개인정보는 보호 기준 준수",
    attachments: ["복무 처리 안내 1부", "인수인계서(서식) 1부"],
  },
  {
    id: "audit-doc-submit",
    category: "보고/조사",
    label: "감사(점검) 자료 제출",
    subject: "감사(또는 점검) 대비 자료 제출 협조 요청",
    details:
      "- 목적: 감사/점검의 원활한 수검 및 자료의 정확한 제출\n- 추진 내용: 제출 대상 자료 안내, 제출 기한 및 방식 안내, 오류·누락 점검\n- 협조 요청: 담당자 자료 제출 및 확인 협조\n- 유의 사항: 개인정보 및 보안 문서는 지정된 방식으로 제출",
    attachments: ["제출 자료 목록 1부", "제출 서식 1부"],
  },
  {
    id: "survey-response",
    category: "보고/조사",
    label: "교육청 설문·조사 응답",
    subject: "설문·조사 응답 및 자료 제출 협조 요청",
    details:
      "- 목적: 상급기관 요청 자료의 정확한 제출 및 기한 준수\n- 추진 내용: 조사 항목 안내, 응답 방법(시스템/서식) 안내, 검토 절차 안내\n- 협조 요청: 담당자 응답 및 근거 자료 제출\n- 유의 사항: 수치·현황은 근거를 확인하고 임의 추정 금지",
    attachments: ["조사 항목 안내 1부", "응답 서식 1부"],
  },
  {
    id: "performance-report",
    category: "보고/조사",
    label: "사업(교육활동) 실적 보고",
    subject: "사업(교육활동) 추진 실적 보고 협조 요청",
    details:
      "- 목적: 사업 추진 현황의 체계적 관리 및 성과 공유\n- 추진 내용: 추진 내용 및 실적 정리, 증빙자료(사진/자료집 등) 취합, 개선 사항 도출\n- 협조 요청: 담당자 실적 및 증빙자료 제출, 기한 준수\n- 유의 사항: 사진·자료 공개 범위 및 개인정보 처리 기준 준수",
    attachments: ["실적 보고서(서식) 1부", "증빙자료 제출 안내 1부"],
  },
  {
    id: "info-disclosure",
    category: "기록/정보공개",
    label: "정보공개 청구 처리 협조",
    subject: "정보공개 청구 처리 관련 자료 제출 협조 요청",
    details:
      "- 목적: 정보공개 청구의 적정 처리 및 기한 준수\n- 추진 내용: 보유 정보 확인, 공개/비공개 대상 검토, 비공개 사유 및 개인정보 마스킹 검토\n- 협조 요청: 관련 부서 보유 자료 제출 및 검토 의견 회신\n- 유의 사항: 개인정보 및 제3자 정보는 관련 법령에 따라 비식별·비공개 처리",
    attachments: ["정보공개 검토표(서식) 1부", "자료 제출 목록 1부"],
  },
  {
    id: "record-management",
    category: "기록/정보공개",
    label: "기록물 관리(정리) 협조",
    subject: "기록물 정리·이관 및 보존 협조 요청",
    details:
      "- 목적: 기록물의 체계적 관리 및 보존\n- 추진 내용: 기록물 분류 및 정리 기준 안내, 이관 대상 선정, 보존기간 확인\n- 협조 요청: 부서별 기록물 정리 및 이관 협조\n- 유의 사항: 개인정보 포함 기록물은 보안 기준 준수",
    attachments: ["기록물 정리 안내 1부", "이관 목록(서식) 1부"],
  },
  {
    id: "external-cooperation",
    category: "대외협력",
    label: "유관기관 협조 요청",
    subject: "유관기관 협조 요청(안)",
    details:
      "- 목적: 학교 교육활동 지원을 위한 유관기관 협력\n- 추진 내용: 협조 요청 배경 및 필요성, 요청 범위(장소/인력/자료/후원 등) 정리, 사전 협의 사항 확인\n- 협조 요청: (1) 협조 가능 여부 회신, (2) 협조 가능 범위 및 조건(비용/제공 가능 자원) 안내, (3) 담당자 지정\n- 회신 요청: 회신 기한 및 회신 방법(공문/메일/유선 등)은 (추후 안내 또는 붙임 참조)\n- 유의 사항: 학생 관련 정보 제공 시 비식별·동의 절차 준수, 안전·보험·책임 범위는 사전 협의",
    attachments: ["협조 요청서(안) 1부"],
  },
  {
    id: "school-events-plan",
    category: "교무/학사",
    label: "학교행사 운영(총괄) 계획",
    subject: "학교행사 운영(총괄) 계획(안) 수립 및 협조 요청",
    details:
      "- 목적: 학기 중 주요 학교행사의 체계적 운영 및 업무 분장 명확화\n- 추진 내용: 행사 일정 및 추진 체계 정리, 담당부서 역할 분담, 안전관리 및 안내 계획 수립\n- 협조 요청: 부서별 추진 계획 및 자료 제출, 행사 당일 운영 협조\n- 유의 사항: 세부 일정/장소 미확정 시 '추후 안내' 또는 '붙임 참조'로 처리",
    attachments: ["행사 운영 계획(안) 1부", "업무 분장표(안) 1부"],
  },
  {
    id: "academic-calendar-submit",
    category: "교무/학사",
    label: "학사일정 취합 협조",
    subject: "학사일정(학년·부서) 취합 및 제출 협조 요청",
    details:
      "- 목적: 연간(또는 학기) 학사일정의 정합성 확보 및 중복 일정 조정\n- 추진 내용: 학년·부서별 일정 취합, 중복/충돌 일정 조정, 최종 일정 공지\n- 협조 요청: 기한 내 일정 제출 및 변경 시 즉시 공유\n- 유의 사항: 교육청 지침 및 학교 사정에 따라 조정 가능",
    attachments: ["학사일정 제출 양식 1부"],
  },
  {
    id: "homeroom-duty-guidance",
    category: "교무/학사",
    label: "담임 업무 안내(학기초)",
    subject: "학기초 담임 업무 안내 및 협조 요청",
    details:
      "- 목적: 학기초 담임 업무의 원활한 운영 및 누락 방지\n- 추진 내용: 출결·생활지도·가정통신문 안내, 기초조사/동의서 회수, 학급 운영 기본 사항 안내\n- 협조 요청: 기한 내 제출 및 학생 개인정보 보호 기준 준수\n- 유의 사항: 학생·학부모 개인정보는 최소 수집 및 안전하게 보관",
    attachments: ["학기초 담임 업무 체크리스트 1부", "기초조사 서식 1부"],
  },
  {
    id: "student-transfer-process",
    category: "교무/학적",
    label: "전·입출 관련 처리 협조",
    subject: "전·입출 관련 학적 처리 및 서류 제출 협조 요청",
    details:
      "- 목적: 전·입출 학생의 학적 처리 정확성 확보\n- 추진 내용: 전입생 배정 및 적응 지원, 전출 서류 처리, 관련 기록(출결/성적/생활기록부) 정리\n- 협조 요청: 담임 및 관련 교과(전담) 교사 서류 확인·제출 협조\n- 유의 사항: 학생 개인정보 포함 문서는 보안 기준 준수",
    attachments: ["학적 처리 안내 1부", "제출 서류 목록 1부"],
  },
  {
    id: "attendance-monthly-check",
    category: "교무/학적",
    label: "출결 점검(월간) 협조",
    subject: "월간 출결 점검 및 정정 협조 요청",
    details:
      "- 목적: 출결 처리의 정확성 확보 및 오류 사전 방지\n- 추진 내용: 월간 출결 현황 점검, 증빙서류 확인, 오류·누락 정정\n- 협조 요청: 담임교사 출결 점검 및 정정 결과 회신\n- 유의 사항: 증빙서류는 개인정보 보호 기준에 따라 관리",
    attachments: ["출결 점검표 1부"],
  },
  {
    id: "school-record-deadline",
    category: "점검/평가",
    label: "생활기록부 기재 마감 안내",
    subject: "학교생활기록부 기재 마감 및 점검 협조 요청",
    details:
      "- 목적: 학교생활기록부 기재의 정확성 확보 및 기한 준수\n- 추진 내용: 기재 마감 일정 안내, 항목별 점검 기준 공유, 오류·누락 보완\n- 협조 요청: 담임 및 교과(전담)교사 기재사항 점검 및 수정\n- 유의 사항: 사실 기반 기재, 민감정보 입력 금지, 증빙자료 관리 준수",
    attachments: ["기재 마감 일정 1부", "점검 체크리스트 1부"],
  },
  {
    id: "school-violence-prevention-plan",
    category: "생활/안전",
    label: "학교폭력 예방 활동 계획",
    subject: "학교폭력 예방 활동 운영 계획(안) 수립 및 협조 요청",
    details:
      "- 목적: 학교폭력 예방 및 안전한 학교문화 조성\n- 추진 내용: 예방교육 및 캠페인 운영, 상담·신고 안내, 사안 발생 시 대응 절차 공유\n- 협조 요청: 학년(군)별 교육 실시 및 운영 협조, 관련 자료 제출\n- 유의 사항: 사례 공유 시 개인정보 비식별 및 2차 피해 방지 준수",
    attachments: ["운영 계획(안) 1부", "교육자료 1부"],
  },
  {
    id: "student-council-operation",
    category: "학생자치",
    label: "학생자치회 운영",
    subject: "학생자치회 운영 계획(안) 수립 및 협조 요청",
    details:
      "- 목적: 학생 참여 확대 및 민주시민 역량 함양\n- 추진 내용: 정기회의 운영, 학생 의견 수렴, 행사·캠페인 기획 및 실행\n- 협조 요청: 담당교사 지도 및 학급별 참여 안내 협조\n- 유의 사항: 학생 개인정보 및 촬영·공유 기준 준수",
    attachments: ["운영 계획(안) 1부", "회의록 서식 1부"],
  },
  {
    id: "cctv-safety-check",
    category: "생활/안전",
    label: "CCTV/학교안전 점검",
    subject: "학교안전(CCTV 등) 점검 실시 및 협조 요청",
    details:
      "- 목적: 학교 안전사고 예방 및 안전 사각지대 최소화\n- 추진 내용: CCTV 작동 상태 점검, 사각지대 확인, 안내 표지 및 출입 관리 점검\n- 협조 요청: 점검 시 출입 및 협조, 이상 발견 시 즉시 보고\n- 유의 사항: 영상정보는 관련 법령에 따라 접근·보관·열람 절차 준수",
    attachments: ["점검표 1부"],
  },
  {
    id: "homepage-update",
    category: "정보/보안",
    label: "학교 홈페이지/가정통신문 게시",
    subject: "학교 홈페이지 게시 및 안내문 탑재 협조 요청",
    details:
      "- 목적: 학교 안내의 적시 제공 및 정보 접근성 향상\n- 추진 내용: 게시 자료 수합, 게시 일정 안내, 게시물 형식 및 개인정보 점검\n- 협조 요청: 담당자 자료 제출 및 게시 전 점검 협조\n- 유의 사항: 개인정보·사진 포함 자료는 동의 및 비식별 기준 준수",
    attachments: ["게시 자료 제출 양식 1부"],
  },
  {
    id: "device-inventory",
    category: "정보/보안",
    label: "정보기기(태블릿/노트북) 실사",
    subject: "정보기기(태블릿/노트북 등) 실사 및 관리 협조 요청",
    details:
      "- 목적: 정보기기 분실·파손 예방 및 효율적 운영\n- 추진 내용: 기기 배부·회수 현황 점검, 상태 확인(파손/수리), 보관 및 사용 수칙 안내\n- 협조 요청: 학급/담당자 현황 제출 및 실사 협조\n- 유의 사항: 기기 사용 시 개인정보 보호 및 보안수칙 준수",
    attachments: ["기기 실사표 1부", "사용 수칙 안내 1부"],
  },
  {
    id: "science-lab-safety",
    category: "시설/안전",
    label: "과학실/실험 안전 점검",
    subject: "과학실(실험·기자재) 안전 점검 및 개선 조치 협조 요청",
    details:
      "- 목적: 실험 활동 안전 확보 및 사고 예방\n- 추진 내용: 실험기구·약품 보관 점검, 안전표지 및 보호구 확인, 위험요소 개선 조치\n- 협조 요청: 점검 참여 및 개선 사항 이행 협조\n- 유의 사항: 위험물·약품은 관련 기준에 따라 관리",
    attachments: ["안전 점검표 1부", "개선 조치 계획(서식) 1부"],
  },
  {
    id: "sports-club-operation",
    category: "행사/체육",
    label: "학교스포츠클럽 운영",
    subject: "학교스포츠클럽 운영 계획(안) 수립 및 협조 요청",
    details:
      "- 목적: 학생 체육활동 활성화 및 건강 증진\n- 추진 내용: 종목 편성, 운영 일정, 안전관리 및 지도 계획, 대회 참가(해당 시)\n- 협조 요청: 지도교사 운영 협조 및 학생 안전 지도\n- 유의 사항: 체육활동 중 안전사고 예방 수칙 준수",
    attachments: ["운영 계획(안) 1부", "운영 일정표 1부"],
  },
  {
    id: "health-room-operation",
    category: "보건",
    label: "보건실 운영(학기) 안내",
    subject: "보건실 운영 안내 및 협조 요청",
    details:
      "- 목적: 학생 건강관리의 원활한 운영\n- 추진 내용: 보건실 이용 기준 안내, 응급상황 대응 절차 공유, 감염병 의심 시 조치 기준 안내\n- 협조 요청: 학급별 안내 및 유증상 학생 관리 협조\n- 유의 사항: 학생 건강정보는 민감정보로 엄격히 보호",
    attachments: ["보건실 운영 안내 1부"],
  },
  {
    id: "health-education-plan",
    category: "보건",
    label: "보건교육 운영 계획",
    subject: "보건교육 운영 계획(안) 수립 및 협조 요청",
    details:
      "- 목적: 학생 건강·안전 역량 강화(감염병, 성교육, 약물오남용 예방 등)\n- 추진 내용: 학년별 교육 계획 수립, 자료 준비, 교육 실적 정리\n- 협조 요청: 담임 및 관련 교원의 교육 운영 협조\n- 유의 사항: 교육 자료 사용 시 적절성 및 개인정보 보호 준수",
    attachments: ["보건교육 운영 계획(안) 1부"],
  },
  {
    id: "meal-allergy-management",
    category: "급식/운영",
    label: "급식 알레르기 관리 협조",
    subject: "급식 알레르기 관리 및 협조 요청",
    details:
      "- 목적: 알레르기 학생 안전 확보 및 사고 예방\n- 추진 내용: 알레르기 정보 확인 및 반영 절차 안내, 교직원 유의사항 공유, 응급 대응 체계 안내\n- 협조 요청: 담임교사 확인 및 변경 사항 즉시 공유\n- 유의 사항: 알레르기 정보는 민감정보로 엄격히 관리",
    attachments: ["알레르기 관리 안내 1부", "확인 서식 1부"],
  },
  {
    id: "after-school-safety",
    category: "방과후/돌봄",
    label: "방과후/늘봄 안전관리 안내",
    subject: "방과후·늘봄(돌봄) 운영 안전관리 및 협조 요청",
    details:
      "- 목적: 방과후·늘봄 운영 중 학생 안전 확보\n- 추진 내용: 출결 확인 및 인계 절차, 귀가 지도, 비상연락체계 및 안전사고 대응 절차 안내\n- 협조 요청: 운영 인력 준수 및 학급 담임과의 정보 공유 협조\n- 유의 사항: 학생 인계는 보호자(또는 지정자) 확인 원칙 준수",
    attachments: ["안전관리 운영 지침 1부", "인계 확인 서식 1부"],
  },
  {
    id: "after-school-instructor-guidance",
    category: "방과후/돌봄",
    label: "방과후 강사 운영 안내",
    subject: "방과후(또는 늘봄) 강사 운영 안내 및 협조 요청",
    details:
      "- 목적: 방과후 프로그램 운영의 안정화 및 수업 품질 확보\n- 추진 내용: 운영 규정 및 준수사항 안내, 출결·안전·지도 기준 안내, 수업자료 및 평가(필요 시) 운영 안내\n- 협조 요청: 강사 준수사항 이행 및 운영 관련 자료 제출\n- 유의 사항: 학생 개인정보·사진 취급 및 외부 공유 금지",
    attachments: ["강사 운영 안내 1부", "서약서(서식) 1부"],
  },
  {
    id: "facility-repair-request",
    category: "시설/환경",
    label: "시설 보수·수리 요청",
    subject: "시설 보수·수리 요청 및 협조",
    details:
      "- 목적: 안전하고 쾌적한 교육환경 유지\n- 추진 내용: 보수 대상 및 우선순위 확인, 수리 일정 조율, 공사(작업) 구역 안전 확보\n- 협조 요청: 작업 중 출입 통제 및 수업 운영 협조, 이상 발견 시 즉시 보고\n- 유의 사항: 공사 관련 안전수칙 및 안내문 준수",
    attachments: ["보수·수리 요청서(서식) 1부", "현장 사진(선택)"],
  },
  {
    id: "school-security-lockup",
    category: "생활/안전",
    label: "문단속/보안 점검 협조",
    subject: "교내 문단속 및 보안 점검 협조 요청",
    details:
      "- 목적: 야간·휴일 보안사고 예방 및 안전한 학교 운영\n- 추진 내용: 교실·특별실 문단속 점검, 전기·가스·소화기 등 안전 점검, 출입문 관리\n- 협조 요청: 사용 후 정리정돈 및 문단속 준수, 이상 발견 시 즉시 보고\n- 유의 사항: 열쇠·출입카드 관리 철저",
    attachments: ["문단속 점검표 1부"],
  },
];

initTemplates("");
const importedFromQuery = applyQueryParamsToFormIfAny();
if (!importedFromQuery) {
  restoreFormState();
}
wireSidebarNav();
if (!dateInput.value) {
  setDefaultDate();
}
setStatus("주제를 입력한 뒤 공문 생성을 누르면 AI가 전체 공문을 작성합니다.");
wireAutoSave();
disableResultDragDrop();
wireResultEditorKeys();
wireTemplateSearch();
updateTemplateSearchHint(templateSearchInput ? templateSearchInput.value : "");
wireOverflowDebug();

form.addEventListener("submit", async (event) => {
  event.preventDefault();

  const payload = collectFormData();
  const subject = payload.subject;
  if (!subject) {
    setStatus("공문 주제를 먼저 입력하세요.");
    subjectInput.focus();
    return;
  }

  setLoading(true);
  setStatus("생성형 AI로 공문을 작성하고 있습니다...");

  try {
    const aiText = await generateDocumentWithAI(payload);
    result.value = aiText.trim();
    persistFormState();
    setStatus("AI 공문 생성이 완료되었습니다. 결과를 필요에 맞게 수정한 뒤 복사/다운로드하세요.");
    result.scrollIntoView({ behavior: "smooth", block: "start" });
  } catch (error) {
    setStatus(error.message || "AI 생성에 실패했습니다. 잠시 후 다시 시도해 주세요.");
  } finally {
    setLoading(false);
  }
});

copyBtn.addEventListener("click", async () => {
  if (!result.value.trim()) {
    setStatus("복사할 내용이 없습니다. 먼저 공문을 생성하세요.");
    return;
  }

  try {
    await navigator.clipboard.writeText(result.value);
    toast("클립보드에 복사했습니다.");
    setStatus("공문 초안을 클립보드에 복사했습니다.");
  } catch (error) {
    result.select();
    document.execCommand("copy");
    toast("복사 권한이 없어 선택 복사로 처리했습니다.", { ms: 2200 });
    setStatus("복사 API 권한이 없어 선택 후 복사를 실행했습니다.");
  }
});

downloadBtn.addEventListener("click", () => {
  if (!result.value.trim()) {
    setStatus("다운로드할 내용이 없습니다. 먼저 공문을 생성하세요.");
    return;
  }

  const payload = collectFormData();
  const filename = buildFilename(payload);
  const blob = new Blob([result.value], { type: "text/plain;charset=utf-8" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);

  toast("TXT를 다운로드했습니다.");
  setStatus("TXT 파일을 다운로드했습니다.");
});

applyTemplateBtn.addEventListener("click", () => {
  const id = String(templateSelect.value || "");
  if (!id) {
    setStatus("적용할 템플릿을 선택하세요.");
    templateSelect.focus();
    return;
  }

  const tpl = TEMPLATES.find((t) => t.id === id);
  if (!tpl) {
    setStatus("템플릿을 찾지 못했습니다.");
    return;
  }

  const view = sanitizeTemplateForQuickUse(tpl);
  subjectInput.value = view.subject;
  detailsInput.value = view.details;
  attachmentsInput.value = (tpl.attachments || []).join("\n");
  setStatus(`템플릿을 적용했습니다: ${view.label}`);
  persistFormState();
  subjectInput.focus();
});

resetBtn.addEventListener("click", () => {
  if (!confirm("입력값을 초기화할까요?")) {
    return;
  }

  subjectInput.value = "";
  recipientInput.value = DEFAULTS.recipient;
  viaInput.value = "";
  senderInput.value = DEFAULTS.sender;
  detailsInput.value = "";
  attachmentsInput.value = "";
  useAttachmentPhraseInput.checked = DEFAULTS.useAttachmentPhrase;
  toneSelect.value = DEFAULTS.tone;
  docnoInput.value = "";
  ownerInput.value = "";
  contactInput.value = "";
  relatedInput.value = "";
  templateSelect.value = "";
  result.value = "";
  setDefaultDate();

  clearFormState();
  setStatus("입력값을 초기화했습니다.");
  subjectInput.focus();
});

templateSelect.addEventListener("change", () => {
  persistFormState();
});

function collectFormData() {
  return {
    subject: subjectInput.value.trim(),
    recipient: recipientInput.value.trim() || DEFAULTS.recipient,
    via: viaInput.value.trim(),
    sender: senderInput.value.trim() || DEFAULTS.sender,
    date: formatDate(dateInput.value),
    details: detailsInput.value.trim(),
    attachments: attachmentsInput.value
      .split("\n")
      .map((line) => line.trim())
      .filter(Boolean),
    useAttachmentPhrase: Boolean(useAttachmentPhraseInput?.checked),
    tone: String(toneSelect?.value || DEFAULTS.tone),
    docno: docnoInput.value.trim(),
    owner: ownerInput.value.trim(),
    contact: contactInput.value.trim(),
    related: relatedInput.value
      .split("\n")
      .map((line) => line.trim())
      .filter(Boolean),
  };
}

async function generateDocumentWithAI(data) {
  const response = await fetch("/api/generate", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify(data),
  });

  const json = await response.json().catch(() => ({}));

  if (!response.ok) {
    if (json.error && String(json.error).includes("OPENAI_API_KEY")) {
      throw new Error("AI 키가 설정되지 않았습니다. Cloudflare Pages의 Variables/Secrets에 OPENAI_API_KEY를 추가해 주세요.");
    }

    throw new Error(`AI 생성 실패: ${json.error || response.status}`);
  }

  if (!json.document) {
    throw new Error("AI 응답에서 공문 본문을 받지 못했습니다.");
  }

  return json.document;
}

function setDefaultDate() {
  const now = new Date();
  const yyyy = now.getFullYear();
  const mm = String(now.getMonth() + 1).padStart(2, "0");
  const dd = String(now.getDate()).padStart(2, "0");
  dateInput.value = `${yyyy}-${mm}-${dd}`;
}

function setLoading(isLoading) {
  submitButton.disabled = isLoading;
  copyBtn.disabled = isLoading;
  downloadBtn.disabled = isLoading;
  applyTemplateBtn.disabled = isLoading;
  resetBtn.disabled = isLoading;
  submitButton.textContent = isLoading ? "AI 작성 중..." : "공문 생성";
}

function formatDate(rawDate) {
  if (!rawDate) {
    return "";
  }

  const [year, month, day] = rawDate.split("-");
  return `${year}. ${Number(month)}. ${Number(day)}.`;
}

function toast(message, { ms = 1800 } = {}) {
  const el = document.getElementById("toast");
  if (!el) return;
  const m = String(message || "").trim();
  if (!m) return;
  el.textContent = m;
  el.classList.add("show");
  clearTimeout(toast._t);
  toast._t = setTimeout(() => {
    el.classList.remove("show");
  }, Math.max(700, Number(ms) || 1800));
}

function setStatus(message) {
  statusText.textContent = message;
}

function disableResultDragDrop() {
  // Prevent accidental drag/drop inside the textarea which can move text.
  result.addEventListener("dragstart", (e) => e.preventDefault());
  result.addEventListener("dragover", (e) => e.preventDefault());
  result.addEventListener("drop", (e) => e.preventDefault());
}

function wireResultEditorKeys() {
  const INDENT = "  "; // 2 spaces; matches common 공문 들여쓰기

  const replaceSelection = (text) => {
    const start = result.selectionStart;
    const end = result.selectionEnd;
    const before = result.value.slice(0, start);
    const after = result.value.slice(end);
    result.value = before + text + after;
    const next = start + text.length;
    result.selectionStart = next;
    result.selectionEnd = next;
    // Trigger autosave wiring.
    result.dispatchEvent(new Event("input", { bubbles: true }));
  };

  const lineStartIndex = (value, idx) => value.lastIndexOf("\n", Math.max(0, idx - 1)) + 1;
  const lineEndIndex = (value, idx) => {
    const end = value.indexOf("\n", idx);
    return end === -1 ? value.length : end;
  };

  const getBlockBounds = (value, start, end) => {
    const bStart = lineStartIndex(value, start);
    const bEnd = lineEndIndex(value, end);
    return [bStart, bEnd];
  };

  const indentLine = (line) => INDENT + line;
  const outdentLine = (line) => {
    if (line.startsWith(INDENT)) return line.slice(INDENT.length);
    if (line.startsWith("\t")) return line.slice(1);
    if (line.startsWith(" ")) return line.slice(1);
    return line;
  };

  result.addEventListener("keydown", (e) => {
    if (e.key === "Tab") {
      e.preventDefault();

      const value = result.value;
      const start = result.selectionStart;
      const end = result.selectionEnd;

      // Multi-line (or any) selection: indent/outdent per line.
      if (start !== end) {
        const [bStart, bEnd] = getBlockBounds(value, start, end);
        const block = value.slice(bStart, bEnd);
        const lines = block.split("\n");
        const nextLines = e.shiftKey ? lines.map(outdentLine) : lines.map(indentLine);
        const nextBlock = nextLines.join("\n");

        result.value = value.slice(0, bStart) + nextBlock + value.slice(bEnd);
        result.selectionStart = bStart;
        result.selectionEnd = bStart + nextBlock.length;
        result.dispatchEvent(new Event("input", { bubbles: true }));
        return;
      }

      // Single caret: indent/outdent current line.
      const ls = lineStartIndex(value, start);
      const le = lineEndIndex(value, start);
      const line = value.slice(ls, le);

      if (e.shiftKey) {
        const nextLine = outdentLine(line);
        const removed = line.length - nextLine.length;
        result.value = value.slice(0, ls) + nextLine + value.slice(le);
        const nextPos = Math.max(ls, start - removed);
        result.selectionStart = nextPos;
        result.selectionEnd = nextPos;
        result.dispatchEvent(new Event("input", { bubbles: true }));
        return;
      }

      // Insert indent at caret.
      replaceSelection(INDENT);
      return;
    }

    if (e.key === "Enter") {
      // Keep the indentation of the current line on newline, like an editor.
      e.preventDefault();

      const value = result.value;
      const start = result.selectionStart;
      const end = result.selectionEnd;
      const ls = lineStartIndex(value, start);
      const le = lineEndIndex(value, start);
      const line = value.slice(ls, le);
      const indent = (line.match(/^[ \t]+/) || [""])[0];

      const before = value.slice(0, start);
      const after = value.slice(end);
      const insert = `\n${indent}`;
      result.value = before + insert + after;
      const nextPos = start + insert.length;
      result.selectionStart = nextPos;
      result.selectionEnd = nextPos;
      result.dispatchEvent(new Event("input", { bubbles: true }));
    }
  });
}

function wireOverflowDebug() {
  // Run only when explicitly requested, e.g.:
  // https://educate1.pages.dev/?debug=1
  const params = new URLSearchParams(window.location.search);
  if (params.get("debug") !== "1") {
    return;
  }

  const run = () => {
    const docW = document.documentElement.clientWidth;
    // eslint-disable-next-line no-console
    console.log("clientWidth:", docW, "scrollWidth:", document.documentElement.scrollWidth);

    const offenders = [];
    document.querySelectorAll("body *").forEach((el) => {
      const r = el.getBoundingClientRect();
      const overflowed = r.left < -1 || r.right > docW + 1;

      const style = getComputedStyle(el);
      const maybeBad = overflowed || (el.scrollWidth > el.clientWidth + 2 && style.overflowX === "visible");

      if (!maybeBad) return;

      offenders.push({
        tag: el.tagName,
        id: el.id,
        class: el.className,
        left: Math.round(r.left),
        right: Math.round(r.right),
        width: Math.round(r.width),
        scrollW: el.scrollWidth,
        clientW: el.clientWidth,
        overflowX: style.overflowX,
        whiteSpace: style.whiteSpace,
      });

      // Visual marker on the actual problematic elements.
      el.style.outline = "2px solid red";
    });

    offenders.sort((a, b) => (b.right - docW) - (a.right - docW));
    // eslint-disable-next-line no-console
    console.table(offenders.slice(0, 20));
  };

  // Wait a tick to ensure layout is settled (fonts, etc).
  window.setTimeout(run, 250);
  window.addEventListener("resize", () => window.setTimeout(run, 100));
}

function initTemplates() {
  // Single picker (no optgroup): optgroup headers were not clickable and felt noisy on mobile.
  // Preserve the first "선택 안 함" option and rebuild the rest.
  while (templateSelect.options.length > 1) {
    templateSelect.remove(1);
  }

  const query = normalizeQuery(arguments[0] || "");
  const filtered = getFilteredTemplates(query);

  const sorted = filtered
    .slice()
    .sort((a, b) => {
      const ac = String(a.category || "").localeCompare(String(b.category || ""), "ko");
      if (ac !== 0) return ac;
      return String(normalizeQuickTemplateLabel(a.label) || "").localeCompare(String(normalizeQuickTemplateLabel(b.label) || ""), "ko");
    });

  for (const tpl of sorted) {
    const view = sanitizeTemplateForQuickUse(tpl);
    const category = String(tpl.category || "기타");
    const opt = document.createElement("option");
    opt.value = tpl.id;
    opt.textContent = `${category} · ${view.label}`;
    templateSelect.appendChild(opt);
  }
}

function templateMatchesQuery(tpl, query) {
  const view = sanitizeTemplateForQuickUse(tpl);
  const cat = String(tpl.category || "").toLowerCase();
  const label = String(view.label || "").toLowerCase();
  const subject = String(view.subject || "").toLowerCase();
  return cat.includes(query) || label.includes(query) || subject.includes(query);
}

function normalizeQuery(value) {
  return String(value || "").trim().toLowerCase();
}

function normalizeQuickTemplateLabel(label) {
  // 빠른 템플릿 표시용: "운영" -> "운영 계획" (이미 "운영 계획"이면 중복 치환하지 않음)
  return String(label || "")
    .replace(/운영(?!\s*계획)/g, "운영 계획")
    .replace(/\s{2,}/g, " ")
    .trim();
}

function applyQueryParamsToFormIfAny() {
  // Cross-service integration hook.
  // Example:
  // https://educate1.pages.dev/?subject=...&details=...&attachments=...
  const params = new URLSearchParams(window.location.search);

  const keys = [
    "subject",
    "details",
    "attachments",
    "recipient",
    "via",
    "sender",
    "date",
    "tone",
    "docno",
    "owner",
    "contact",
    "related",
    "template",
    "templateSearch",
    "result",
  ];

  const hasAny = keys.some((k) => params.has(k));
  if (!hasAny) return false;

  if (params.has("subject")) subjectInput.value = params.get("subject") || "";
  if (params.has("details")) detailsInput.value = params.get("details") || "";
  if (params.has("attachments")) attachmentsInput.value = params.get("attachments") || "";
  if (params.has("recipient")) recipientInput.value = params.get("recipient") || "";
  if (params.has("via")) viaInput.value = params.get("via") || "";
  if (params.has("sender")) senderInput.value = params.get("sender") || "";
  if (params.has("date")) dateInput.value = params.get("date") || "";
  if (params.has("tone")) toneSelect.value = params.get("tone") || DEFAULTS.tone;
  if (params.has("docno")) docnoInput.value = params.get("docno") || "";
  if (params.has("owner")) ownerInput.value = params.get("owner") || "";
  if (params.has("contact")) contactInput.value = params.get("contact") || "";
  if (params.has("related")) relatedInput.value = params.get("related") || "";
  if (params.has("result")) result.value = params.get("result") || "";

  if (templateSearchInput && params.has("templateSearch")) {
    templateSearchInput.value = params.get("templateSearch") || "";
    initTemplates(templateSearchInput.value);
    updateTemplateSearchHint(templateSearchInput.value);
  }

  if (params.has("template")) {
    const templateId = params.get("template") || "";
    if (templateId) templateSelect.value = templateId;
  }

  persistFormState();
  return true;
}

function wireSidebarNav() {
  const sidebar = document.getElementById("sidebar");
  const scrim = document.getElementById("scrim");
  const navToggle = document.getElementById("navToggle");
  const navClose = document.getElementById("navClose");

  if (!sidebar || !scrim || !navToggle || !navClose) return;

  const setOpen = (open) => {
    document.body.classList.toggle("nav-open", open);
    navToggle.setAttribute("aria-expanded", open ? "true" : "false");
    scrim.setAttribute("aria-hidden", open ? "false" : "true");
  };

  navToggle.addEventListener("click", () => setOpen(!document.body.classList.contains("nav-open")));
  navClose.addEventListener("click", () => setOpen(false));
  scrim.addEventListener("click", () => setOpen(false));

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") setOpen(false);
  });

  sidebar.addEventListener("click", (e) => {
    const a = e.target && e.target.closest ? e.target.closest("a") : null;
    if (a) setOpen(false);
  });
}

function stripCoopFromSubject(subject) {
  // 제목/주제에서 협조 관련 표현 제거
  let s = String(subject || "");
  s = s.replace(/및\s*협조\s*요청/g, "");
  s = s.replace(/협조\s*요청/g, "");
  s = s.replace(/협조/g, "");
  s = s.replace(/\s+\(/g, "(");
  s = s.replace(/\(\s+/g, "(");
  s = s.replace(/\s+\)/g, ")");
  s = s.replace(/\s{2,}/g, " ").trim();
  s = s.replace(/\s*및\s*$/g, "").trim();
  return s;
}

function stripCoopFromDetails(details) {
  const lines = String(details || "").split("\n");
  const kept = [];
  for (let line of lines) {
    // "협조 요청" 소항목은 제거
    if (/^\s*-\s*협조\s*요청\s*:/.test(line)) continue;

    line = line.replace(/협조\s*요청/g, "");
    line = line.replace(/협조\s*\(/g, "(");
    line = line.replace(/협조/g, "");
    line = line.replace(/\s+\(/g, "(");
    line = line.replace(/\(\s+/g, "(");
    line = line.replace(/\s+\)/g, ")");
    line = line.replace(/\s+,/g, ",");
    line = line.replace(/\s{2,}/g, " ").trim();

    if (line) kept.push(line);
  }
  return kept.join("\n").trim();
}

function sanitizeTemplateForQuickUse(tpl) {
  return {
    ...tpl,
    label: normalizeQuickTemplateLabel(tpl?.label),
    subject: stripCoopFromSubject(tpl?.subject),
    details: stripCoopFromDetails(tpl?.details),
  };
}

function shouldExcludeTemplateFromQuickList(tpl) {
  const subject = String(tpl?.subject || "");
  const category = String(tpl?.category || "");

  // 대외 협조 성격 템플릿은 빠른 템플릿에서 제외
  if (tpl?.id === "external-cooperation" || category.includes("대외")) return true;

  const isCoopRequest = subject.includes("협조 요청");
  const isPlan = subject.includes("계획");
  return isCoopRequest && !isPlan;
}

function getFilteredTemplates(query) {
  const base = TEMPLATES.filter((t) => !shouldExcludeTemplateFromQuickList(t));
  if (!query) return base.slice();
  return base.filter((t) => templateMatchesQuery(t, query));
}

function wireTemplateSearch() {
  if (!templateSearchInput) return;

  const applyFilter = () => {
    const current = String(templateSelect.value || "");
    const query = templateSearchInput.value || "";
    initTemplates(query);
    updateTemplateSearchHint(query);

    if (current) {
      // Restore selection if still present after filtering.
      const exists = Array.from(templateSelect.options).some((o) => o.value === current);
      templateSelect.value = exists ? current : "";
    }
    persistFormState();
  };

  let timer = null;
  templateSearchInput.addEventListener("input", () => {
    clearTimeout(timer);
    timer = setTimeout(applyFilter, 120);
  });

  templateSearchInput.addEventListener("search", applyFilter);
}

function updateTemplateSearchHint(rawQuery) {
  if (!templateSearchHint) return;
  const query = normalizeQuery(rawQuery);
  if (!query) {
    templateSearchHint.textContent = "";
    return;
  }
  const count = getFilteredTemplates(query).length;
  templateSearchHint.textContent = count ? `검색 결과: ${count}개` : "검색 결과 없음";
}

function buildFilename(payload) {
  const base = (payload.subject || "공문").replace(/[\\/:*?\"<>|]+/g, " ").trim();
  const date = String(dateInput.value || "").trim(); // yyyy-mm-dd
  const ymd = date ? date.replaceAll("-", "") : "document";
  return `${ymd}_${base}.txt`.slice(0, 120);
}

function wireAutoSave() {
  const targets = [
    subjectInput,
    recipientInput,
    viaInput,
    senderInput,
    dateInput,
    detailsInput,
    attachmentsInput,
    useAttachmentPhraseInput,
    toneSelect,
    docnoInput,
    ownerInput,
    contactInput,
    relatedInput,
    templateSelect,
    result,
  ];

  let timer = null;
  const schedule = () => {
    clearTimeout(timer);
    timer = setTimeout(() => persistFormState(), 250);
  };

  for (const el of targets) {
    if (!el) continue;
    el.addEventListener("input", schedule);
    el.addEventListener("change", schedule);
  }
}

function persistFormState() {
  const state = {
    subject: subjectInput.value,
    recipient: recipientInput.value,
    via: viaInput.value,
    sender: senderInput.value,
    date: dateInput.value,
    details: detailsInput.value,
    attachments: attachmentsInput.value,
    useAttachmentPhrase: Boolean(useAttachmentPhraseInput?.checked),
    tone: toneSelect.value,
    docno: docnoInput.value,
    owner: ownerInput.value,
    contact: contactInput.value,
    related: relatedInput.value,
    templateSearch: templateSearchInput ? templateSearchInput.value : "",
    templateId: templateSelect.value,
    result: result.value,
  };

  try {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  } catch {
    // Ignore storage errors (private mode, quota, etc.)
  }
}

function restoreFormState() {
  try {
    const raw = localStorage.getItem(STORAGE_KEY);
    if (!raw) return;
    const state = JSON.parse(raw);
    if (!state || typeof state !== "object") return;

    if (typeof state.subject === "string") subjectInput.value = state.subject;
    if (typeof state.recipient === "string") recipientInput.value = state.recipient;
    if (typeof state.via === "string") viaInput.value = state.via;
    if (typeof state.sender === "string") senderInput.value = state.sender;
    if (typeof state.date === "string") dateInput.value = state.date;
    if (typeof state.details === "string") detailsInput.value = state.details;
    if (typeof state.attachments === "string") attachmentsInput.value = state.attachments;
    if (typeof state.useAttachmentPhrase === "boolean") useAttachmentPhraseInput.checked = state.useAttachmentPhrase;
    if (typeof state.tone === "string") toneSelect.value = state.tone;
    if (typeof state.docno === "string") docnoInput.value = state.docno;
    if (typeof state.owner === "string") ownerInput.value = state.owner;
    if (typeof state.contact === "string") contactInput.value = state.contact;
    if (typeof state.related === "string") relatedInput.value = state.related;
    if (templateSearchInput && typeof state.templateSearch === "string") {
      templateSearchInput.value = state.templateSearch;
      initTemplates(state.templateSearch);
      updateTemplateSearchHint(state.templateSearch);
    }
    const templateId =
      typeof state.templateId === "string"
        ? state.templateId
        : (typeof state.template === "string" ? state.template : "");
    if (templateId) templateSelect.value = templateId;
    if (typeof state.result === "string") result.value = state.result;
  } catch {
    // Ignore parse/storage errors.
  }
}

function clearFormState() {
  try {
    localStorage.removeItem(STORAGE_KEY);
  } catch {
    // Ignore.
  }
}
